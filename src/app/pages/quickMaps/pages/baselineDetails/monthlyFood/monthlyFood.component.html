<ng-template #componentTemplate>
  <mat-tab-group mat-align-tabs="center" [(selectedIndex)]="selectedTab">
    <mat-tab label="Stacked Bar">
      <canvas #stackedChart>{{ chartDataStack }}</canvas>
      <!-- <ngx-chartjs id="stacked-chart" *ngIf="chartDataStack" [data]="chartDataStack.data" [type]="chartDataStack.type"
        [options]="chartDataStack.options">
      </ngx-chartjs> -->
    </mat-tab>

    <mat-tab label="Line Chart">
      <canvas #lineChart>{{ chartDataLine }}</canvas>
      <!-- <ngx-chartjs id="line-chart" *ngIf="chartDataLine" [data]="chartDataLine.data" [type]="chartDataLine.type"
        [options]="chartDataLine.options">
      </ngx-chartjs> -->
    </mat-tab>

    <mat-tab label="Table (All Data)">
      <div class="bmgf-maps-nice-scrollbar">
        <table mat-table [dataSource]="dataSource" matSort>
          <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumns; first as isFirst">
            <th mat-header-cell *matHeaderCellDef mat-sort-header arrowPosition="before">{{column}}<ng-container
                *ngIf="!isFirst"> ({{
                quickMapsService.micronutrient.get().unit }}/month)</ng-container>
            </th>
            <td mat-cell *matCellDef="let element">
              <span *ngIf="isLikelyANumericString(element[column])">{{element[column] | sigFig:3}}</span>
              <span *ngIf="!isLikelyANumericString(element[column])">{{element[column]}}</span>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </div>
    </mat-tab>

    <mat-tab label="Download">
      <app-download [chartDownloadPNG]="chartPNG" [chartDownloadPDF]="chartPDF" [dataArray]="dataSource?.data">
      </app-download>
    </mat-tab>
    <mat-tab label="About these estimates">
      <div class="about-container">
        <h2>About these estimates</h2>
        <p>This view presents the median monthly apparent intake of micronutrients, where the household data capture
          enables this disaggregation. Data are available to view graphically as stacked proportions (default view) or
          by absolute value. Data can also be viewed in tabular form. All outputs can be downloaded and exported.</p>
      </div>

    </mat-tab>
  </mat-tab-group>
</ng-template>

<ng-container *ngIf="(null != dialogData) else componentTemplate">
  <app-base-dialog [data]="dialogData" [title]="title">
    <ng-container *ngTemplateOutlet="componentTemplate"></ng-container>
  </app-base-dialog>
</ng-container>